<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace="INSTR_INFO">
    
    <!-- 교수정보  가져오기 -->
    <select id="prlist" resultType="com.teamp.cau.dto.professorDTO">
    	select * from INSTR_INFO;
    	
    </select>
    
    <!-- 교수정보 검색 -->
    <select id="search" parameterType="HashMap" resultType="com.teamp.cau.dto.professorDTO">
    	select * from INSTR_INFO
    		<choose>
    			<when test="name_search != null and code_search != null">
    				where korn_flnm like '%${name_search}%' and crclm_cd like '%${code_search}%';
    			</when>
    			<when test="name_search != null and (code_search == null or code_search == '')">
    				where korn_flnm like '%${name_search}%';
    			</when>
    			<when test="(name_search == null or name_search =='') and code_search != null">
    			where crclm_cd like '%${code_search}%';
    			</when>
    			<otherwise>
				</otherwise>
    		</choose>
    </select>
    
    <!-- 교수정보 입력  -->
    <insert id="prinfo_save" parameterType="HashMap" >
    	insert into INSTR_INFO(INSTR_NO, KORN_FLNM, CRCLM_CD, USER_BRDT, EML_ADDR, TELNO)
    	values (#{pr_no}, #{pr_name}, #{pr_dep}, #{pr_birth}, #{pr_email}, #{pr_telno});
    </insert>
   	
   	
   	<!-- 권한주기 -->
   	<update id="INSTR_auth" parameterType="HashMap">
   		update INSTR_INFO set
   		ENDST_NO = #{authority}
   		where INSTR_NO = #{pr_no};
   	</update>
   	
   	<!-- 본인정보수정 수정 및 저장  -->
   	<update id="self_modify" parameterType="HashMap">
   		update INSTR_INFO set 
   		ENG_FLNM=#{name_en}, ADDR=#{roadAddrPart1}, DADDR=#{addrDetail}, GENDER=#{pr_gender}, IMG_FILE =#{IMG_FILE}
   		where INSTR_NO=#{pr_no};
   	</update>
   	
    </mapper>